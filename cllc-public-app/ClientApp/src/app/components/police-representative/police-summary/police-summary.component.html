<div class="form-wrapper position-relative">
    <div [ngBusy]="[busy]"></div>


<div class="form-wrapper-summary" *ngIf="application">

  <div class="row">
    <div style="width: 70%">
    <h1 class="mat-heading">{{application.eventName}}</h1>
    <h3>Start Date: {{application.eventStartDate | date: 'dd MMM yyyy'}}</h3>
    <h3>Application number: {{application.tempJobNumber}}</h3>
    <h2>APPROVALS REQUIRED FROM LCRB AND POLICE</h2>
    <h3>Approvals are assigned to:</h3>
    <table class="servings" style="width:50%">
        <tr>
            <th>POLICE DETACHMENT &nbsp;</th>
            <th>LCRB &nbsp;</th>
        </tr>
        <tr>
            <td>{{application?.policeDecisionBy?.name ? application.policeDecisionBy.name : "No one is assigned"}}&nbsp;</td>
            <td>{{application?.lcrbApprovalBy?.name ? application.lcrbApprovalBy.name : "No one is assigned"}}&nbsp;</td>

        </tr>
        <tr>
          <td><em>{{application?.policeApproval}}</em></td>
          <td><em>{{application?.lcrbApproval}}</em></td>
      </tr>

    </table>
  </div>
  <div style="margin-top: 30px; text-align: center; width: 30%; ">
    <!-- approve and deny buttons -->

    <mat-card style="background-color: #e0e0e0; min-height: 200px;">

    <section *ngIf="this.isApproved()">
      <!--if approved-->
      <h3><fa-icon [icon]="faCheck" style="margin-right: 10px;"></fa-icon>Approved</h3>
      <p>This application for liquor service has been reviewed and accepted.</p>

      <p *ngIf="application?.policeApproval == 'Auto Approved'">It was within the review threshold and was automatically accepted by your jurisdiction.</p>

    </section>

    <section *ngIf="application?.eventStatus == 'PendingReview'">
      <!-- if denied -->
      <h3><fa-icon [icon]="faQuestionCircle" style="margin-right: 10px;"></fa-icon>Pending Review</h3>
      <p>Liquor service for this event has been denied for the following reason:</p>
      <p><em>{{application?.denialReason}}</em></p>
    </section>

    <section *ngIf="application?.eventStatus == 'Denied'">
      <!-- if denied -->
      <h3><fa-icon [icon]="faBan" style="margin-right: 10px;"></fa-icon>Denied</h3>
      <p>Liquor service for this event has been denied for the following reason:</p>
      <p><em>{{application?.denialReason}}</em></p>
    </section>

    <section >
      <!-- if opened by assignee and event date has not passed -->

    <button *ngIf="!this.isApproved() && this.isCurrentUser() && application?.policeApproval == 'Pending Review'" class="btn btn-primary"  (click)=approve() style="width:230px;">
      <!-- if not already approved -->
        COMPLETE REVIEW&nbsp;
      </button>
      <p *ngIf="!this.isApproved() && application?.policeApproval == 'Approved'"><em>This application has been reviewed by your jurisdiction but is still pending review by LCRB.</em></p>

      <hr>
      <button class="btn btn-secondary" (click)="deny()" style="width: 230px;">
        DENY LIQUOR SERVICE&nbsp;
      </button>
    </section>

    </mat-card>
  </div>
  </div>
  <div class="row">
    <div style="width: 20%; text-align:center;">
      <p><small>status</small></p>
      <p><strong>{{application?.eventStatus}}</strong></p>
      <h1><fa-icon [icon]="faStopwatch"></fa-icon></h1>
    </div>
    <div style="width: 20%; text-align:center;">
      <p><small>size</small></p>
      <p><strong>{{this.getSize()}}</strong></p>
      <p><strong>{{application?.maximumNumberOfGuests}}</strong></p>
      <p><small><em>Accross {{this.getNumberOfLocations()}} location<span>{{this.getNumberOfLocations() > 1 ? 's' : ''}}</span></em></small></p>

    </div>
  </div>
<!--
    <h2>Summary</h2>

    <mat-expansion-panel [expanded]="true">
        <mat-expansion-panel-header>
            <mat-panel-title>
                GENERAL APPLICATION INFO
            </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="d-flex">
            <label>Event Municipality</label> <span>{{application?.sepCity?.name}}</span>
        </div>
        <div class="d-flex">
            <label>Applicant Name</label> <span>{{application?.applicant?.name}}</span>
        </div>
        <div class="d-flex">
            <label>Applicant Info</label>
            <section>
                <div>{{application?.applicant?.address1_line1}}</div>
                <div>{{application?.applicant?.address1_city}}</div>
                <div>{{application?.applicant?.address1_stateorprovince}}</div>
                <div>{{application?.applicant?.address1_postalcode}}</div>
                <div>{{application?.applicant?.telephone1}}</div>
                <div>{{application?.applicant?.emailaddress1}}</div>
            </section>
        </div>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="true">
        <mat-expansion-panel-header>
            <mat-panel-title>
                ELIGIBILITY
            </mat-panel-title>
        </mat-expansion-panel-header>
        <div class="d-flex">
            <label>Event Starts at:</label> <span>{{application?.eventStartDate | date: 'dd MMM yyyy'}}</span>
        </div>
        <div class="d-flex">
            <label>Responsible Beverage Service #:</label> <span>Agassiz</span>
        </div>
        <div class="d-flex">
            <label>Name of The Organization:</label> <span>Agassiz</span>
        </div>
        <div class="d-flex">
            <label>Address of The Organization:</label> <span>Agassiz</span>
        </div>
        <div class="d-flex">
            <label>Occasion of event:</label> <span>Firstname Lastname</span>
        </div>
        <div class="d-flex">
            <label>Licence Already exists in location:</label> <span>Yes</span>
        </div>
        <div class="d-flex">
            <label>Permit Category</label> <span>Private – Family and Invited Friends Only</span>
        </div>
        <div class="d-flex">
            <label>Public Property</label> <span>Yes</span>
        </div>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="true">
        <div *ngFor="let location of application.eventLocations; index as i">
            <mat-expansion-panel-header>
                <mat-panel-title>
                    EVENT LOCATION {{i+1}}
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="d-flex">
                <label>Location Name</label> <span>{{location.locationName}}</span>
            </div>
            <div class="d-flex">
                <label>Location Description</label> <span>UNKNOWN FIELD</span>
            </div>
            <div class="d-flex">
                <label>Event Address</label>
                <section>
                    <span>{{location.eventLocationStreet1}}</span>
                    <span>{{location.eventLocationStreet2}}</span>

                    <span>{{location.eventLocationCity}}, {{location.eventLocationProvince}}</span>
                    <span>{{location.eventLocationPostalCode}}</span>
                </section>
            </div>

            <div *ngFor="let serviceArea of location.serviceAreas">
                <div class="d-flex">
                    <label>Service Area Description</label> <span>{{serviceArea.licencedAreaDescription}}</span>
                </div>
                <div class="d-flex">
                    <label>Maximum # of Guests in Service Areas</label> <span>{{serviceArea.licencedAreaMaxNumberOfGuests}}</span>
                </div>
                <div class="d-flex">
                    <label>Minors Present</label> <span>{{serviceArea.numberOfMinors}}</span>
                </div>
                <div class="d-flex">
                    <label>Maximum # of Guests at this location</label> <span>{{serviceArea.maximumNumberOfGuests}}</span>
                </div>

            </div>


            <h4>Event date</h4>
            <div *ngFor="let eventDate of location.eventDates"></div>
            <div class="d-flex">
                <label>Start Date</label> <span>{{eventDate.eventDate | date: 'dd MMM yyyy'}} </span>
                <label>Start Time</label> <span>{{eventDate.eventStartValue}} - {{eventDate.eventEndValue}} </span>
                <label>Liquor Service</label> <span>{{eventDate.serviceStartValue}} - {{eventDate.serviceStartValue}} </span>
            </div>
        </div>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="true">
        <mat-expansion-panel-header>
            <mat-panel-title>
                LIQUOR FEES
            </mat-panel-title>
        </mat-expansion-panel-header>

        <div class="d-flex">
            <label>Liquor Quantities</label>
            <table class="servings">
                <tr>
                    <th>Type</th>
                    <th>Servings</th>
                </tr>
                <tr *ngFor="let item of application.drinksSalesForecasts">
                    <td>{{item.name}}</td>
                    <td>{{item.estimatedServings}}</td>
                </tr>
            </table>
        </div>

        <hr>
        <div class="d-flex">
            <label>Estimated total liquor sales revenue</label> <span class="fee-amount">[$0.00]</span>
        </div>
        <div class="d-flex">
            <label>Estimated liquor purchase cost</label> <span class="fee-amount">[$0.00]</span>
        </div>
        <div class="d-flex">
            <label>Estimated net proceeds/profit from liquor sales</label> <span class="fee-amount">[$0.00]</span>
        </div>
        <div class="d-flex">
            <label>Total PST Amount Due</label> <span class="fee-amount">[$0.00]</span>
        </div>
        <div class="d-flex">
            <label>Application Fees (Based on 1 event location and capacity)*
                *0-500 – $25.00</label> <span class="fee-amount">[$0.00]</span>
        </div>

        <hr>

    </mat-expansion-panel>
  -->
    <hr>
</div>

