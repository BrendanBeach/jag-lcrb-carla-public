<div class="dashboard-spacing" style="position: relative">
  <mat-progress-bar class="mt-1" *ngIf="!dataLoaded" mode="indeterminate"></mat-progress-bar>

  <div *ngIf="dataLoaded">
    <div [formGroup]="form" style="padding-left: 45px; position: relative">
      <!-- Title -->
      <h1 class="ngtest-page-title">Non-Default T &amp; C Change Application</h1>
    </div>

    <div [formGroup]="form" class="application-wrapper">     
      <h3 class="blue-header">CURRENT TEXT</h3>
      <section class="padded-section content-bottom">
        <app-field label="Licence" [required]="false">
          <input class="form-control" style="width: 300px;" type="text" [readonly]="true"
                 formControlName="licenseNumber">
        </app-field>

        <app-field label="Establishment Name" [required]="false">
          <input class="form-control" style="width: 500px;" type="text" [readonly]="true" formControlName="establishmentName">
        </app-field>

        <app-field label="T & C Text" [required]="false">
          <input class="form-control" style="width: 500px;" type="text" [readonly]="true" formControlName="termText">
        </app-field>
      </section>

      <!-- Requested change -->
      <h3 class="blue-header">REQUEST CHANGE</h3>
      <div class="content-bottom">

        <p>
          A letter of intent describing , in detail, the proposed change to your licence.  To request discretion,
          provide a written submission detailing compelling reasons/exceptional circumstances for your request and
          why a request for discretion should be approved.  All documentation to support your request for
          discretion must be submitted with this application.
        </p>
          <app-field label="Reason for change" [valid]="isValidOrNotTouched('description2')"
                     errorMessage="Please enter the reason for the change">
            <textarea style="width: 500px;" class="form-control" formControlName="description2"></textarea>           
          </app-field>

        </div>

      <h3 class="blue-header ngtest-declarations">
        DECLARATIONS
      </h3>
      <div class="padded-section content-bottom">
        <section>
          <div>
            The application must only be submitted by an individual with the authority to bind the applicant. The
            branch
            relies on the applicant to ensure that the individual who submits this application is authorized to do
            so.
            Typically, an appropriate individual in a corporation will be a duly authorized signatory who will
            usually
            be
            an officer or, in some cases, a director.
          </div>
        </section>
        <p>
          Note: A lawyer or
          consultant,
          may NOT submit this application on behalf of
          the applicant.
        </p>

        <app-field [valid]="!showValidationMessages || form.get('authorizedToSubmit').valid"
                   errorMessage="Please affirm that you are authorized to submit the application." [showChevrons]="false">
          <mat-checkbox formControlName="authorizedToSubmit">
            <span class="error-states">*</span>
            <span class="ml-2">
              I understand and affirm that I am authorized to submit the application
            </span>
          </mat-checkbox>
        </app-field>
        <p *ngIf="licence?.licenseType === 'Cannabis Retail Store'">
          Section 22(2) of the Cannabis Control and Licensing Act states: “A person must not submit to the general
          manager
          an application, or
          information or a record included as part of the application, that contains false or misleading
          information, or
          fails to disclose a material fact”.
        </p>
        <p *ngIf="licence?.licenseType !== 'Cannabis Retail Store'">
          Section 20(1) of the Liquor Control and Licensing Act states: “The general manager may refuse to issue, renew,
          transfer or amend a licence if the applicant fails to disclose a material fact required by the application or
          makes a false or misleading statement in the application.”
        </p>
        <app-field [valid]="!showValidationMessages || form.get('signatureAgreement').valid"
                   errorMessage="Please affirm that all of the information provided for this application is true and complete."
                   [showChevrons]="false">
          <mat-checkbox formControlName="signatureAgreement">
            <span class="error-states">*</span>
            <span class="ml-2">
              I understand and affirm that all of the information provided for this
              application is true and complete
            </span>
          </mat-checkbox>
        </app-field>
      </div>

      <p></p>
      <section class="error" *ngIf="showValidationMessages">
        <p *ngFor="let message of validationMessages">
          <span class="app-cancel">
            <mat-icon aria-label="error icon" style="font-size: 15px;">error</mat-icon>
            {{message}}
          </span>
        </p>
      </section>

      <section style="margin-top: 20px; position: relative;">
        <button class="btn btn-primary" (click)="initiateTransfer()">
          <fa-icon [icon]="faSave" style="color: #fff;"></fa-icon>
          SUBMIT CHANGE REQUEST
        </button>
        <span style="color: #1a5a96; float: right; padding-top: 10px;">
          <a routerLink="/dashboard">
            <fa-icon [icon]="faTrashAlt" style="color: #1a5a96;"></fa-icon>
            Cancel Change Request
          </a>
        </span>
        <div [ngBusy]="busy"></div>
      </section>
    </div>
  </div>
</div>

