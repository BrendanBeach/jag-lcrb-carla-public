<div class="form-wrapper" style="position: relative;">
  <div [ngBusy]="[busy]"></div>
  <form [formGroup]="form" class="col-lg-7 col-sm-12">
    <div class="padded-section">
      <h1>Temporary Use Area Event</h1>
    </div>

    <div class="padded-section">
      <p>Please provide the details requested below regarding your event.</p>
    </div>

    <div class="padded-section">
      <h2>Status: <b>{{status}}</b></h2>
      <h3 *ngIf="licenceEvent != null && licenceEvent.eventNumber != null">Number: <b>{{licenceEvent.eventNumber}}</b>
      </h3>
    </div>

    <h3 class="blue-header">EVENT INFORMATION</h3>
    <section class="content-bottom clearfix">
      <div class="row">
        <app-field class="col-md-4 col-xs-12" label="Event Name" [required]="true" [valid]="isValidOrNotTouched('name')"
          errorMessage="Please enter the event name" [isFullWidth]="true">
          <input class="form-control" type="text" formControlName="name">
        </app-field>
      </div>
    </section>

    <h3 class="blue-header">CONTACT INFORMATION</h3>
    <section class="content-bottom clearfix">
      <div class="row">
        <app-field class="col-md-4 col-xs-12" label="Name" [required]="true" [isFullWidth]="true"
          [valid]="isValidOrNotTouched('contactName')" errorMessage="Please enter the contact name">
          <input class="form-control" type="text" formControlName="contactName">
        </app-field>
        <fa-icon [icon]="faQuestionCircle" class="question-mark"
          matTooltip="The name of the contact person for the event."></fa-icon>
        <app-field class="col-md-4 col-xs-12" label="Phone" [required]="true" [isFullWidth]="true"
          [valid]="isValidOrNotTouched('contactPhone')" errorMessage="Please enter the contact phone number">
          <input class="form-control" type="text" formControlName="contactPhone" mask="(000) 000-0000">
        </app-field>
      </div>
      <div class="row">
        <app-field class="col-md-4 col-xs-12" label="Email" [required]="true" [isFullWidth]="true"
          [valid]="isValidOrNotTouched('contactEmail')">
          <input class="form-control" type="text" formControlName="contactEmail">
        </app-field>
      </div>
    </section>

    <h3 class="blue-header">TUA LOCATION(S)</h3>
    <section class="content-bottom clearfix">
      <p>Specify one or more locations where your event will take place.</p>
      <div class="row">
        <p>TODO</p>
      </div>
      <div class="row">
      </div>
      <div class="row">
      </div>
    </section>

    <h3 class="blue-header">TIME AND DATE OF EVENT</h3>
    <section class="content-bottom clearfix">
      <div class="row">
        <app-field class="col-md-2 col-xs-6" label="Start Date" [required]="true"
          [valid]="isValidOrNotTouched('startDate')" [isFullWidth]="true">
          <input type="text" formControlName='startDate' placeholder="yyyy-mm-dd" class="form-control"
            [min]="startDateMinimum" [matDatepicker]="startPicker" (focus)="startPicker.open()"
            (click)="startPicker.open()" (dateChange)="startDateChanged()">
          <mat-datepicker #startPicker></mat-datepicker>
        </app-field>
        <app-field class="col-md-2 col-xs-6" label="End Date" [required]="true" [valid]="isValidOrNotTouched('endDate')"
          [isFullWidth]="true">
          <input type="text" formControlName='endDate' placeholder="yyyy-mm-dd" class="form-control"
            [min]="endDateMinimum" [matDatepicker]="endPicker" (focus)="endPicker.open()" (click)="endPicker.open()"
            (dateChange)="endDateChanged()">
          <mat-datepicker #endPicker></mat-datepicker>
        </app-field>
      </div>
      <div *ngFor="let fg of timeForms.controls" class="row mx-0 mt-3 event-hours">
        <form [formGroup]="fg" class="col-md-12">
          <div class="row mt-3">
            <div class="col-md-2 offset-md-2"><label>Event Start</label></div>
            <div class="col-md-2"><label>Event End</label></div>
          </div>
          <div class="row">
            <div class="col-md-2 time-picker-title">
              <h4>{{fg.get('dateTitle').value === null ? 'Default Times' : fg.get('dateTitle').value}}</h4>
            </div>
            <div class="col-md-2">
              <ngb-timepicker [meridian]="true" formControlName="startTime"></ngb-timepicker>
            </div>
            <div class="col-md-2">
              <ngb-timepicker [meridian]="true" formControlName="endTime"></ngb-timepicker>
            </div>
          </div>
        </form>
      </div>
      <div class="row">
        <app-field class="col-xs-12">
          <mat-checkbox [checked]="scheduleIsInconsistent" (change)="toggleScheduleConsistency()"
            [disabled]="form.get('startDate').invalid || form.get('endDate').invalid || isReadOnly">
            The event times are different on specific dates.</mat-checkbox>
        </app-field>
      </div>
    </section>

    <h3 class="blue-header">EVENT DETAILS</h3>
    <section class="content-bottom clearfix">
      <div class="row">
        <app-field class="col-md-4 col-xs-12" label="Event Maximum Attendance" [required]="true"
          [valid]="isValidOrNotTouched('maxAttendance')"
          errorMessage="Please enter the maximum attendance (must be a number)" [isFullWidth]="true">
          <input class="form-control" type="number" formControlName="maxAttendance">
        </app-field>
        <app-field class="col-md-4 col-xs-12" label="Minors Attending" [required]="true"
          [valid]="isValidOrNotTouched('minorsAttending')" errorMessage="Please indicate if minors are attending"
          [isFullWidth]="true">
          <select class="form-control" formControlName="minorsAttending">
            <option value="true">Yes</option>
            <option value="false">No</option>
          </select>
        </app-field>
      </div>
      <div class="row">
        <app-field class="col-md-4 col-xs-12" label="Description" [required]="true"
          [valid]="isValidOrNotTouched('eventTypeDescription')" errorMessage="Please enter a description of the event"
          [isFullWidth]="true">
          <textarea class="form-control" formControlName="eventTypeDescription"></textarea>
        </app-field>
        <fa-icon [icon]="faQuestionCircle" class="question-mark" matTooltip="Briefly describe the event."></fa-icon>
      </div>
      <div class="row">
        <p>Select all the items that will be part of your event:</p>
        <div class="col-md-4 col-xs-12">
          <mat-checkbox formControlName="isWedding"></mat-checkbox>
          <mat-checkbox formControlName="isNetworkingParty"></mat-checkbox>
          <mat-checkbox formControlName="isConcert"></mat-checkbox>
          <mat-checkbox formControlName="isNoneOfTheAbove"></mat-checkbox>
        </div>
        <div class="col-md-4 col-xs-12">
          <mat-checkbox formControlName="isBanquet"></mat-checkbox>
          <mat-checkbox formControlName="isAmplifiedSound"></mat-checkbox>
          <mat-checkbox formControlName="isDancing"></mat-checkbox>
        </div>
        <div class="col-md-4 col-xs-12">
          <mat-checkbox formControlName="isReception"></mat-checkbox>
          <mat-checkbox formControlName="isLiveEntertainment"></mat-checkbox>
          <mat-checkbox formControlName="isGambling"></mat-checkbox>
        </div>
      </div>
    </section>


    <h3 class="blue-header">AGREEMENT</h3>
    <section class="content-bottom">
      <p>A person commits an offence if the person provides false or misleading information in the following
        circumstances: (i) when making an application referred to in section 12; (ii) when making a report or when
        required and as specified by the general manager under section 59. - Liquor Control and Licensing Act, Section
        57(1)(c).</p>
      <div>
        <mat-checkbox formControlName="agreement">I understand and affirm that all of the information provided is true
          and complete.</mat-checkbox>
      </div>
    </section>

    <section class="p-3 attention-section">
      <p>The information requested on this form is collected by the Liquor and Cannabis Regulation Branch under Section
        26 (a) and (c) of the Freedom of Information and Protection of Privacy Act and will be used for the purpose of
        liquor licensing and compliance and enforcement matters in accordance with the Liquor Control and Licensing Act.
        Should you have any questions about the collection, use, or disclosure of personal information, please contact
        the Freedom of Information Officer at PO Box 9292 STN PROV GVT, Victoria, BC, V8W 9J8 or by phone toll free at
        1-866-209-2111.</p>
    </section>

    <section class="error mt-3" *ngIf="showErrorSection">
      <p *ngFor="let message of validationMessages">
        <span class="app-cancel">
          <mat-icon aria-label="error icon" style="font-size: 15px;">error</mat-icon>
          {{message}}
        </span>
      </p>
    </section>

    <div class="p-4 button-row">
      <button class="btn btn-secondary" style="margin-right:10px;" (click)="save(false);" *ngIf="!isReadOnly">
        <span>
          <fa-icon [icon]="faSave"></fa-icon>SAVE FOR LATER
        </span>
      </button>
      <button class="btn btn-primary" (click)="save(true)" *ngIf="!isReadOnly">SUBMIT</button>
      <button class="btn btn-link btn-cancel" (click)="cancel();">
        <span *ngIf="isReadOnly">RETURN TO DASHBOARD</span>
        <span *ngIf="!isReadOnly">
          <fa-icon [icon]="faTrash"></fa-icon>CANCEL EVENT
        </span>
      </button>
    </div>
  </form>
</div>
